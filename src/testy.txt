describe("My First Test", () => {
  it("visit website and login", () => {
    cy.visit("http://127.0.0.1:5173/");

    cy.get('[data-cy="loginButton"]').should("be.visible").click();

    const testEmail = "wiktoria@o2.pl";
    const testPassword = "wiktoria";
    cy.get('[data-cy="emailLogin"]').type(testEmail);
    cy.get('[data-cy="passwordLogin"]').type(testPassword);

    cy.get('[data-cy="login-submit"]').children().should("be.visible");
    cy.get('[data-cy="login-submit"]').click();
  });
});


describe("Google", () => {
  beforeEach(() => {
    cy.log("Logging in to Google");
    cy.visit("http://127.0.0.1:5173/");
    cy.get('[data-cy="loginButton"]').should("be.visible").click();
    cy.get('[data-cy="google-login"]').should("be.visible").click();
    cy.request({
      method: "POST",
      url: "https://accounts.google.com/o/oauth2/token",
      body: {
        grant_type: "refresh_token",
        client_id: "694833864391-ppbl21m4mbptbgatc1557mleuekia3up.apps.googleusercontent.com",
        client_secret: "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",
        refresh_token:
          "ya29.a0AbVbY6NOvD3lT-0AEiflxKhB68Zl0Bnlv7gaiYxaC_Llm1imhkJYXmi1RxQ85WZHvXXCZh1JEeqa3LS8q9XFNQvIKu5bHtSCtm-w1bW_M_W5gXrmEJzoEUw6f98cyuuYIRgJI54GI-NcNjPUsGDTqwHGLT64GAaCgYKAZgSARESFQFWKvPl7vESN3K92jTrozXy_owIrw0165",
      },
      rejectUnauthorized: false,
    }).then(({ body }) => {
      const { access_token, id_token } = body;

      cy.request({
        method: "GET",
        url: "https://www.googleapis.com/oauth2/v3/userinfo",
        headers: { Authorization: `Bearer ${access_token}` },
      }).then(({ body }) => {
        cy.log(body);

        const userItem = {
          token: id_token,
          user: {
            googleId: body.sub,
            email: body.email,
            givenName: body.name,
            familyName: body.family_name,
            imageUrl: body.picture,
          },
        };
        cy.log(userItem);
      });
    });
  });

  it("shows onboarding", () => {
    cy.log("jestesmy tu");
  });
});

import { defineConfig } from "cypress";

export default defineConfig({
  e2e: {
    setupNodeEvents(on, config) {
      // implement node event listeners here
    },
  },
});
